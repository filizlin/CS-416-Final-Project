<!DOCTYPE html>
<html>
  <script src="http://d3js.org/d3.v4.min.js"></script>
  <style>
    circle {
      fill: lightblue;
      stroke: black;
    }
    .axis {
      font: 14px sans-serif;
    }
  </style>
  <body>
    <div id="scatterPlot"></div>
    <script>
      //load data
      const dataURL =
        "https://raw.githubusercontent.com/filizlin/CS-416-Final-Project/main/Ethnic%20data.csv";

      //set up x, y, and color scaling
      var margin = { top: 10, right: 10, bottom: 20, left: 20 },
        width = 700 + margin.top + margin.bottom,
        height = 600 + margin.left + margin.right;

      // create the container SVG element
      const svg = d3
        .create("svg")
        .attr("width", width + 100)
        .attr("height", height + 100);

      d3.csv(dataURL).then(data => {
        data.forEach((d) => {
          d.perc = +d.perc;
        });

        var x = d3
          .scaleLinear()
          .domain([2015, 2021])
          .range([margin.top, height - margin.bottom])
          .nice();
        var y = d3
          .scaleLinear()
          .domain([0, 100])
          .range([height - margin.bottom, margin.top])
          .nice();
        var color = d3.scaleOrdinal(d3.schemeCategory10);

        // set up y-axis
        svg
          .append("g")
          .attr("class", "axis")
          .attr("transform", `translate(${5 * margin.left},${margin.top})`)
          .call(
            d3
              .axisLeft(y)
              .tickValues([0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100])
          )
          .append("text")
          .attr("transform", `translate(-${5 * margin.left}, 450) rotate(-90)`)
          .attr("text-anchor", "end")
          .attr("fill", "black")
          .attr("font-size", "16px")
          .attr("x", width * 0.5)
          .attr("y", +50)
          .text(
            "Percent Completion of Transfer-level Math and English Course during First Year"
          );

        //set up x-axis
        svg
          .append("g")
          .attr("class", "axis")
          .attr(
            "transform",
            `translate(${4.5 * margin.left}, ${height - margin.top})`
          )
          .call(
            d3
              .axisBottom(x)
              .tickValues([2015, 2016, 2017, 2018, 2019, 2020, 2021])
              .tickSize(16)
              .tickFormat(d3.format("d"))
          )
          .append("text")
          .attr("text-anchor", "end")
          .attr("fill", "black")
          .attr("font-size", "16px")
          .attr("x", width * 0.5)
          .attr("y", +60)
          .text("Academic Year");

        // add circle for each point
        const graph = svg
          .selectAll("circle")
          .data(data)
          .enter()
          .append("circle")
          .attr("cx", function (d) {
            return x(parseInt(d.academicYear));
          })
          .attr("cy", function (d) {
            return y(parseInt(d.perc) * 100);
          })
          .attr("r", 5)
          .attr("fill", function (d) {
            return color(d.subgroup);
          });
      });
    </script>
  </body>
</html>
